<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.scene.control.DatePicker?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.SplitPane?>
<?import javafx.scene.control.TableColumn?>
<?import javafx.scene.control.TableView?>
<?import javafx.scene.control.TextArea?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.RowConstraints?>
<?import javafx.scene.layout.VBox?>

<BorderPane prefHeight="700.0" prefWidth="900.0" style="-fx-background-color: transparent;" xmlns="http://javafx.com/javafx/24.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.oop4clinic.clinicmanagement.controller.admin.DoctorManagementController">

    <!-- Thanh tiêu đề + tìm kiếm / hành động nhanh -->
    <top>
        <VBox spacing="12.0" style="-fx-background-color: transparent;">
            <Label style="-fx-text-fill:#0088ff; -fx-font-size:20; -fx-font-weight:bold;" text="Quản lý bác sĩ" />
            <HBox spacing="10.0">
                <TextField fx:id="txtSearch" promptText="Tìm theo tên / SĐT / Email" HBox.hgrow="ALWAYS" />
                <ComboBox fx:id="cbDepartment" promptText="Khoa" />
                <ComboBox fx:id="cbSpecialty" promptText="Chuyên môn" />
                <ComboBox fx:id="cbActive" promptText="Trạng thái" />
                <Button fx:id="btnFilter" onAction="#onApplyFilterTop" text="Lọc" />
                <Button mnemonicParsing="false" onAction="#onClearFilterTop" text="Xóa Lọc" />
                <Region HBox.hgrow="ALWAYS" />
                <Button fx:id="btnImport" text="Import" />
                <Button fx:id="btnExport" text="Export" />
                <Button fx:id="btnAdd" onAction="#onAddDoctor" style="-fx-background-color:#1e80c7; -fx-text-fill:white;" text="+ Thêm bác sĩ" />
            </HBox>
        </VBox>
    </top>

    <!-- Thân: bảng bên trái + form chi tiết bên phải -->
    <center>
        <SplitPane fx:id="split" dividerPositions="0.75" prefWidth="922.0">
            <!-- KHỐI TRÁI: DANH SÁCH -->
            <VBox spacing="10.0" style="-fx-background-color:#ddefff; -fx-background-radius:20; -fx-padding:12;">
                <Label style="-fx-text-fill:#0088ff; -fx-font-size:16; -fx-font-weight:bold;" text="Danh sách bác sĩ" />
                <TableView fx:id="tblDoctors" minWidth="0.0" onMouseClicked="#onDoctorTableClicked" VBox.vgrow="ALWAYS">
                    <columns>
                        <TableColumn fx:id="colCode" text="Mã" />
                        <TableColumn fx:id="colFullName" prefWidth="180" text="Họ tên" />
                        <TableColumn fx:id="colDepartment" prefWidth="120.0" text="Khoa" />
                        <TableColumn fx:id="colGender" text="Giới tính" />
                        <TableColumn fx:id="colStatus" prefWidth="110.0" text="Trạng thái" />
                        <TableColumn fx:id="colPhone" prefWidth="110.0" text="SĐT" />
                        <TableColumn fx:id="colEmail" prefWidth="150.0" text="Email" />
                        <TableColumn fx:id="colFee" prefWidth="100.0" text="Phí khám" />
                    </columns>
                    <columnResizePolicy>
                        <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                    </columnResizePolicy>
                </TableView>
            </VBox>

            <!-- KHỐI PHẢI: CHI TIẾT / FORM -->
            <VBox fx:id="detailPane" minWidth="0.0" spacing="10.0" style="-fx-background-color:#ddefff; -fx-background-radius:20; -fx-padding:12;">
                <HBox>
                    <Label style="-fx-text-fill:#0088ff; -fx-font-size:16; -fx-font-weight:bold;" text="Chi tiết bác sĩ" />
                    <Region HBox.hgrow="ALWAYS" />
                    <Button fx:id="btnEdit" disable="true" onAction="#onUpdateDoctor" text="Sửa" />
                    <Button fx:id="btnSave" onAction="#onSaveDoctor" style="-fx-background-color:#1e80c7; -fx-text-fill:white;" text="Lưu" />
                    <Button fx:id="btnDeactivate" text="Ngưng kích hoạt" />
                </HBox>

                <!-- FORM GRID 2 CỘT -->
                <GridPane hgap="12" vgap="10">
                    <columnConstraints>
                        <ColumnConstraints percentWidth="35" />
                        <ColumnConstraints percentWidth="65" />
                    </columnConstraints>

                    <Label text="Họ tên:" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                    <TextField fx:id="txtFullName" GridPane.columnIndex="1" GridPane.rowIndex="0" />

                    <Label text="Giới tính:" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                    <ComboBox fx:id="cbGender" GridPane.columnIndex="1" GridPane.rowIndex="1" />

                    <Label text="Ngày sinh:" GridPane.columnIndex="0" GridPane.rowIndex="2" />
                    <DatePicker fx:id="dpDob" GridPane.columnIndex="1" GridPane.rowIndex="2" />

                    <Label text="SĐT:" GridPane.columnIndex="0" GridPane.rowIndex="3" />
                    <TextField fx:id="txtPhone" GridPane.columnIndex="1" GridPane.rowIndex="3" />

                    <Label text="Email:" GridPane.columnIndex="0" GridPane.rowIndex="4" />
                    <TextField fx:id="txtEmail" GridPane.columnIndex="1" GridPane.rowIndex="4" />

                    <Label text="Khoa:" GridPane.columnIndex="0" GridPane.rowIndex="5" />
                    <ComboBox fx:id="cbDepartmentForm" GridPane.columnIndex="1" GridPane.rowIndex="5" />

                    <Label text="Trạng thái" GridPane.columnIndex="0" GridPane.rowIndex="6" />
                    <ComboBox fx:id="doctorStatus" prefWidth="150.0" GridPane.columnIndex="1" GridPane.rowIndex="6" />

                    <Label text="Phí khám:" GridPane.columnIndex="0" GridPane.rowIndex="7" />
                    <TextField fx:id="txtFee" promptText="VD: 350000" GridPane.columnIndex="1" GridPane.rowIndex="7" />

                    <Label text="Địa chỉ:" GridPane.columnIndex="0" GridPane.rowIndex="8" />
                    <TextArea fx:id="txtAddress" prefRowCount="2" GridPane.columnIndex="1" GridPane.rowIndex="8" />

                    <Label text="Ghi chú:" GridPane.columnIndex="0" GridPane.rowIndex="9" />
                    <TextArea fx:id="txtNotes" prefRowCount="2" GridPane.columnIndex="1" GridPane.rowIndex="9" />

                    <rowConstraints>
                        <RowConstraints />
                        <RowConstraints />
                        <RowConstraints />
                        <RowConstraints />
                        <RowConstraints />
                        <RowConstraints />
                        <RowConstraints minHeight="10.0" prefHeight="30.0" />
                        <RowConstraints />
                        <RowConstraints />
                        <RowConstraints />
                    </rowConstraints>
                </GridPane>

                <!-- Nút Tạo tài khoản - căn giữa -->
                <HBox alignment="CENTER" style="-fx-padding: 12 0 0 0;">
                    <Button fx:id="btnCreateAccount" onAction="#onCreateDoctorAccount" style="-fx-background-color: linear-gradient(to right, #1e80c7, #409eff);                                    -fx-text-fill: white;                                    -fx-font-weight: bold;                                    -fx-padding: 8 18;                                    -fx-background-radius: 20;                                    -fx-cursor: hand;" text="Tạo tài khoản" />
                </HBox>
            </VBox>
        </SplitPane>
    </center>

    <!-- FOOTER -->
    <bottom>
        <HBox style="-fx-padding:6 0 0 0;">
            <Label style="-fx-text-fill:#666; -fx-font-size:11;" text="* SĐT &amp; Email là duy nhất. Không xoá cứng bác sĩ đã có dữ liệu — dùng Ngưng kích hoạt." />
        </HBox>
    </bottom>

    <padding>
        <Insets bottom="0" left="0" right="0" top="4" />
    </padding>
</BorderPane>
